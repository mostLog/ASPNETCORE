layui.define("layer", function (f) { var h = layui.$, k = layui.layer, e = layui.hint(), b = layui.device(), n = "form", c = ".layui-form", p = "layui-this", o = "layui-show", g = "layui-hide", j = "layui-disabled", i = function () { this.config = { verify: { required: [/[\S]+/, "必填项不能为空"], phone: [/^1\d{10}$/, "请输入正确的手机号"], email: [/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/, "邮箱格式不正确"], url: [/(^#)|(^http(s*):\/\/[^\s]+\.[^\s]+)/, "链接格式不正确"], number: [/^\d+$/, "只能填写数字"], date: [/^(\d{4})[-\/](\d{1}|0\d{1}|1[0-2])([-\/](\d{1}|0\d{1}|[1-2][0-9]|3[0-1]))*$/, "日期格式不正确"], identity: [/(^\d{15}$)|(^\d{17}(x|X|\d)$)/, "请输入正确的身份证号"] } } }; i.prototype.set = function (q) { var r = this; h.extend(true, r.config, q); return r }; i.prototype.verify = function (q) { var r = this; h.extend(true, r.config.verify, q); return r }; i.prototype.on = function (q, r) { return layui.onevent.call(this, n, q, r) }; i.prototype.render = function (s, r) { var t = this, u = h(c + function () { return r ? ('[lay-filter="' + r + '"]') : "" }()), q = { select: function () { var x = "请选择", D = "layui-form-select", w = "layui-select-title", z = "layui-select-none", B = "", v, A = u.find("select"), y = function (F, E) { if (!h(F.target).parent().hasClass(w) || E) { h("." + D).removeClass(D + "ed " + D + "up"); v && B && v.val(B) } v = null }, C = function (L, F, J) { var N = h(this), K = L.find("." + w), M = K.find("input"), H = L.find("dl"), O = H.children("dd"); if (F) { return } var I = function () { var R = L.offset().top + L.outerHeight() + 5 - l.scrollTop(), Q = H.outerHeight(); L.addClass(D + "ed"); O.removeClass(g); if (R + Q > l.height() && R >= Q) { L.addClass(D + "up") } }, G = function (Q) { L.removeClass(D + "ed " + D + "up"); M.blur(); if (Q) { return } E(M.val(), function (R) { if (R) { B = H.find("." + p).html(); M && M.val(B) } }) }; K.on("click", function (Q) { L.hasClass(D + "ed") ? (G()) : (y(Q, true), I()); H.find("." + z).remove() }); K.find(".layui-edge").on("click", function () { M.focus() }); M.on("keyup", function (R) { var Q = R.keyCode; if (Q === 9) { I() } }).on("keydown", function (R) { var Q = R.keyCode; if (Q === 9) { G() } else { if (Q === 13) { R.preventDefault() } } }); var E = function (T, U, Q) { var R = 0; layui.each(O, function () { var W = h(this), X = W.text(), V = X.indexOf(T) === -1; if (T === "" || (Q === "blur") ? T !== X : V) { R++ } Q === "keyup" && W[V ? "addClass" : "removeClass"](g) }); var S = R === O.length; return U(S), S }; var P = function (S) { var Q = this.value, R = S.keyCode; if (R === 9 || R === 13 || R === 37 || R === 38 || R === 39 || R === 40) { return false } E(Q, function (T) { if (T) { H.find("." + z)[0] || H.append('<p class="' + z + '">无匹配项</p>') } else { H.find("." + z).remove() } }, "keyup"); if (Q === "") { H.find("." + z).remove() } }; if (J) { M.on("keyup", P).on("blur", function (Q) { v = M; B = H.find("." + p).html(); setTimeout(function () { E(M.val(), function (R) { if (R && !B) { M.val("") } }, "blur") }, 200) }) } O.on("click", function () { var S = h(this), R = S.attr("lay-value"); var Q = N.attr("lay-filter"); if (S.hasClass(j)) { return false } if (S.hasClass("layui-select-tips")) { M.val("") } else { M.val(S.text()); S.addClass(p) } S.siblings().removeClass(p); N.val(R).removeClass("layui-form-danger"); layui.event.call(this, n, "select(" + Q + ")", { elem: N[0], value: R, othis: L }); G(true); return false }); L.find("dl>dt").on("click", function (Q) { return false }); h(document).off("click", y).on("click", y) }; A.each(function (J, M) { var E = h(this), F = E.next("." + D), G = this.disabled, O = M.value, H = h(M.options[M.selectedIndex]), I = M.options[0]; if (typeof E.attr("lay-ignore") === "string") { return E.show() } var K = typeof E.attr("lay-search") === "string", N = I ? (I.value ? x : (I.innerHTML || x)) : x; var L = h(['<div class="layui-unselect ' + D + (G ? " layui-select-disabled" : "") + '">', '<div class="' + w + '"><input type="text" placeholder="' + N + '" value="' + (O ? H.html() : "") + '" ' + (K ? "" : "readonly") + ' class="layui-input layui-unselect' + (G ? (" " + j) : "") + '">', '<i class="layui-edge"></i></div>', '<dl class="layui-anim layui-anim-upbit' + (E.find("optgroup")[0] ? " layui-select-group" : "") + '">' + function (Q) { var P = []; layui.each(Q, function (R, S) { if (R === 0 && !S.value) { P.push('<dd lay-value="" class="layui-select-tips">' + (S.innerHTML || x) + "</dd>") } else { if (S.tagName.toLowerCase() === "optgroup") { P.push("<dt>" + S.label + "</dt>") } else { P.push('<dd lay-value="' + S.value + '" class="' + (O === S.value ? p : "") + (S.disabled ? (" " + j) : "") + '">' + S.innerHTML + "</dd>") } } }); P.length === 0 && P.push('<dd lay-value="" class="' + j + '">没有选项</dd>'); return P.join("") }(E.find("*")) + "</dl>", "</div>"].join("")); F[0] && F.remove(); E.after(L); C.call(this, L, G, K) }) }, checkbox: function () { var x = { checkbox: ["layui-form-checkbox", "layui-form-checked", "checkbox"], _switch: ["layui-form-switch", "layui-form-onswitch", "switch"] }, v = u.find("input[type=checkbox]"), w = function (A, z) { var y = h(this); A.on("click", function () { var B = y.attr("lay-filter"), C = (y.attr("lay-text") || "").split("|"); if (y[0].disabled) { return } y[0].checked ? (y[0].checked = false, A.removeClass(z[1]).find("em").text(C[1])) : (y[0].checked = true, A.addClass(z[1]).find("em").text(C[0])); layui.event.call(y[0], n, z[2] + "(" + B + ")", { elem: y[0], value: y[0].value, othis: A }) }) }; v.each(function (D, z) { var B = h(this), H = B.attr("lay-skin"), y = B.attr("lay-event"), G = (B.attr("lay-text") || "").split("|"), C = this.disabled; if (H === "switch") { H = "_" + H } var F = x[H] || x.checkbox; if (typeof B.attr("lay-ignore") === "string") { return B.show() } var A = B.next("." + F[0]); var E = h(['<div class="layui-unselect ' + F[0] + (z.checked ? (" " + F[1]) : "") + (C ? " layui-checkbox-disbaled " + j : "") + '" lay-skin="' + (H || "") + '" lay-event="' + (y || "") + '">', { _switch: "<em>" + ((z.checked ? G[0] : G[1]) || "") + "</em><i></i>" }[H] || ((z.title.replace(/\s/g, "") ? ("<span>" + z.title + "</span>") : "") + '<i class="layui-icon">' + (H ? "&#xe605;" : "&#xe618;") + "</i>"), "</div>"].join("")); A[0] && A.remove(); B.after(E); w.call(this, E, F) }) }, radio: function () { var w = "layui-form-radio", y = ["&#xe643;", "&#xe63f;"], x = u.find("input[type=radio]"), v = function (A) { var B = h(this), z = "layui-anim-scaleSpring"; A.on("click", function () { var D = B[0].name, C = B.parents(c); var F = B.attr("lay-filter"); var E = C.find("input[name=" + D.replace(/(\.|#|\[|\])/g, "\\$1") + "]"); if (B[0].disabled) { return } layui.each(E, function () { var G = h(this).next("." + w); this.checked = false; G.removeClass(w + "ed"); G.find(".layui-icon").removeClass(z).html(y[1]) }); B[0].checked = true; A.addClass(w + "ed"); A.find(".layui-icon").addClass(z).html(y[0]); layui.event.call(B[0], n, "radio(" + F + ")", { elem: B[0], value: B[0].value, othis: A }) }) }; x.each(function (C, B) { var E = h(this), z = E.next("." + w), D = this.disabled; if (typeof E.attr("lay-ignore") === "string") { return E.show() } var A = h(['<div class="layui-unselect ' + w + (B.checked ? (" " + w + "ed") : "") + (D ? " layui-radio-disbaled " + j : "") + '">', '<i class="layui-anim layui-icon">' + y[B.checked ? 0 : 1] + "</i>", "<span>" + (B.title || "未命名") + "</span>", "</div>"].join("")); z[0] && z.remove(); E.after(A); v.call(this, A) }) } }; s ? (q[s] ? q[s]() : e.error("不支持的" + s + "表单渲染")) : layui.each(q, function (v, w) { w() }); return t }; var m = function () { var v = h(this), x = a.config.verify, y = null, w = "layui-form-danger", z = {}, u = v.parents(c), q = u.find("*[lay-verify]"), s = v.parents("form")[0], r = u.find("input,select,textarea"), t = v.attr("lay-filter"); layui.each(q, function (C, D) { var F = h(this), B = F.attr("lay-verify").split("|"); var A = "", E = F.val(); F.removeClass(w); layui.each(B, function (I, G) { var H = typeof x[G] === "function"; if (x[G] && (H ? A = x[G](E, D) : !x[G][0].test(E))) { k.msg(A || x[G][1], { icon: 5, shift: 6 }); if (!b.android && !b.ios) { D.focus() } F.addClass(w); return y = true } }); if (y) { return y } }); if (y) { return false } layui.each(r, function (A, B) { if (!B.name) { return } if (/^checkbox|radio$/.test(B.type) && !B.checked) { return } z[B.name] = B.value }); return layui.event.call(this, n, "submit(" + t + ")", { elem: this, form: s, field: z }) }; var a = new i(), d = h(document), l = h(window); a.render(); d.on("reset", c, function () { var q = h(this).attr("lay-filter"); setTimeout(function () { a.render(null, q) }, 50) }); d.on("submit", c, m).on("click", "*[lay-submit]", m); f(n, a) });